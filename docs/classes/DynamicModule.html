<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>DynamicModule | kysely</title><meta name="description" content="Documentation for kysely"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><link rel="stylesheet" href="../assets/custom.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">kysely</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">kysely</a></li><li><a href="DynamicModule.html">DynamicModule</a></li></ul><h1>Class DynamicModule</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel tsd-hierarchy"><h3>Hierarchy</h3><ul class="tsd-hierarchy"><li><span class="target">DynamicModule</span></li></ul></section><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Constructors</h3><ul class="tsd-index-list"><li class="tsd-kind-constructor tsd-parent-kind-class"><a href="DynamicModule.html#constructor" class="tsd-kind-icon">constructor</a></li></ul></section><section class="tsd-index-section "><h3>Methods</h3><ul class="tsd-index-list"><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><a href="DynamicModule.html#ref" class="tsd-kind-icon">ref</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Constructors</h2><section class="tsd-panel tsd-member tsd-kind-constructor tsd-parent-kind-class"><a id="constructor" class="tsd-anchor"></a><h3>constructor</h3><ul class="tsd-signatures tsd-kind-constructor tsd-parent-kind-class"><li class="tsd-signature tsd-kind-icon">new <wbr/>Dynamic<wbr/>Module<span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="DynamicModule.html" class="tsd-signature-type" data-tsd-kind="Class">DynamicModule</a></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><h4 class="tsd-returns-title">Returns <a href="DynamicModule.html" class="tsd-signature-type" data-tsd-kind="Class">DynamicModule</a></h4></li></ul></section></section><section class="tsd-panel-group tsd-member-group "><h2>Methods</h2><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><a id="ref" class="tsd-anchor"></a><h3>ref</h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><li class="tsd-signature tsd-kind-icon">ref<span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol">(</span>reference<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">DynamicReferenceBuilder</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span><span class="tsd-signature-symbol">&gt;</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/koskimas/kysely/blob/ea1c637/src/dynamic/dynamic.ts#L90">src/dynamic/dynamic.ts:90</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Creates a dynamic reference to a column that is not know at compile time.</p>
</div><div><p>Kysely is built in a way that by default you can&#39;t refer to tables or columns
that are not actually visible in the current query and context. This is all
done by typescript at compile time, which means that you need to know the
columns and tables at compile time. This is not always the case of course.</p>
<p>This method is meant to be used in those cases where the column names
come from the user input or are not otherwise known at compile time.</p>
<p>WARNING! Unlike values, column names are not escaped by the database engine
or Kysely and if you pass in unchecked column names using this method, you
create an SQL injection vulnerability. Always <strong>always</strong> validate the user
input before passing it to this method.</p>
<p>There are couple of examples below for some use cases, but you can pass
<code>ref</code> to other methods as well. If the types allow you to pass a <code>ref</code>
value to some place, it should work.</p>
</div><dl class="tsd-comment-tags"><dt>example</dt><dd><p>Filter by a column not know at compile time:</p>
<pre><code class="language-ts"><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-8">someQuery</span><span class="hl-1">(</span><span class="hl-3">filterColumn</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1">, </span><span class="hl-3">filterValue</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-7">ref</span><span class="hl-1"> } = </span><span class="hl-3">db</span><span class="hl-1">.</span><span class="hl-3">dynamic</span><br/><br/><span class="hl-1">  </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-3">db</span><br/><span class="hl-1">    .</span><span class="hl-8">selectFrom</span><span class="hl-1">(</span><span class="hl-4">&#39;person&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-8">selectAll</span><span class="hl-1">()</span><br/><span class="hl-1">    .</span><span class="hl-8">where</span><span class="hl-1">(</span><span class="hl-8">ref</span><span class="hl-1">(</span><span class="hl-3">filterColumn</span><span class="hl-1">), </span><span class="hl-4">&#39;=&#39;</span><span class="hl-1">, </span><span class="hl-3">filterValue</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-8">execute</span><span class="hl-1">()</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">someQuery</span><span class="hl-1">(</span><span class="hl-4">&#39;first_name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Arnold&#39;</span><span class="hl-1">)</span><br/><span class="hl-8">someQuery</span><span class="hl-1">(</span><span class="hl-4">&#39;person.last_name&#39;</span><span class="hl-1">, </span><span class="hl-4">&#39;Aniston&#39;</span><span class="hl-1">)</span>
</code></pre>
</dd><dt>example</dt><dd><p>Order by a column not know at compile time:</p>
<pre><code class="language-ts"><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-8">someQuery</span><span class="hl-1">(</span><span class="hl-3">orderBy</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-7">ref</span><span class="hl-1"> } = </span><span class="hl-3">db</span><span class="hl-1">.</span><span class="hl-3">dynamic</span><br/><br/><span class="hl-1">  </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-3">db</span><br/><span class="hl-1">    .</span><span class="hl-8">selectFrom</span><span class="hl-1">(</span><span class="hl-4">&#39;person&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-8">select</span><span class="hl-1">(</span><span class="hl-4">&#39;person.first_name as fn&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-8">orderBy</span><span class="hl-1">(</span><span class="hl-8">ref</span><span class="hl-1">(</span><span class="hl-3">orderBy</span><span class="hl-1">))</span><br/><span class="hl-1">    .</span><span class="hl-8">execute</span><span class="hl-1">()</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">someQuery</span><span class="hl-1">(</span><span class="hl-4">&#39;fn&#39;</span><span class="hl-1">)</span>
</code></pre>
</dd><dt>example</dt><dd><p>In this example we add selections dynamically:</p>
<pre><code class="language-ts"><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-7">ref</span><span class="hl-1"> } = </span><span class="hl-3">db</span><span class="hl-1">.</span><span class="hl-3">dynamic</span><br/><br/><span class="hl-5">// Some column name provided by the user. Value not known at compile time.</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-7">columnFromUserInput</span><span class="hl-1"> = </span><span class="hl-3">req</span><span class="hl-1">.</span><span class="hl-3">query</span><span class="hl-1">.</span><span class="hl-3">select</span><span class="hl-1">;</span><br/><br/><span class="hl-5">// A type that lists all possible values `columnFromUserInput` can have.</span><br/><span class="hl-5">// You can use `keyof Person` if any column of an interface is allowed.</span><br/><span class="hl-0">type</span><span class="hl-1"> </span><span class="hl-2">PossibleColumns</span><span class="hl-1"> = </span><span class="hl-4">&#39;last_name&#39;</span><span class="hl-1"> | </span><span class="hl-4">&#39;first_name&#39;</span><span class="hl-1"> | </span><span class="hl-4">&#39;birth_date&#39;</span><br/><br/><span class="hl-0">const</span><span class="hl-1"> [</span><span class="hl-7">person</span><span class="hl-1">] = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-3">db</span><span class="hl-1">.</span><span class="hl-8">selectFrom</span><span class="hl-1">(</span><span class="hl-4">&#39;person&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-8">select</span><span class="hl-1">([</span><br/><span class="hl-1">    </span><span class="hl-8">ref</span><span class="hl-1">&lt;</span><span class="hl-2">PossibleColumns</span><span class="hl-1">&gt;(</span><span class="hl-3">columnFromUserInput</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-4">&#39;id&#39;</span><br/><span class="hl-1">  ])</span><br/><span class="hl-1">  .</span><span class="hl-8">execute</span><span class="hl-1">()</span><br/><br/><span class="hl-5">// The resulting type contains all `PossibleColumns` as optional fields</span><br/><span class="hl-5">// because we cannot know which field was actually selected before</span><br/><span class="hl-5">// running the code.</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-7">lastName</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1"> | </span><span class="hl-2">undefined</span><span class="hl-1"> = </span><span class="hl-3">person</span><span class="hl-1">.</span><span class="hl-3">last_name</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-7">firstName</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1"> | </span><span class="hl-2">undefined</span><span class="hl-1"> = </span><span class="hl-3">person</span><span class="hl-1">.</span><span class="hl-3">first_name</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-7">birthDate</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1"> | </span><span class="hl-2">undefined</span><span class="hl-1"> = </span><span class="hl-3">person</span><span class="hl-1">.</span><span class="hl-3">birth_date</span><br/><br/><span class="hl-5">// The result type also contains the compile time selection `id`.</span><br/><span class="hl-3">person</span><span class="hl-1">.</span><span class="hl-3">id</span>
</code></pre>
</dd></dl></div><h4 class="tsd-type-parameters-title">Type parameters</h4><ul class="tsd-type-parameters"><li><h4>R<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span> = <span class="tsd-signature-type">never</span></h4></li></ul><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>reference: <span class="tsd-signature-type">string</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">DynamicReferenceBuilder</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type" data-tsd-kind="Type parameter">R</span><span class="tsd-signature-symbol">&gt;</span></h4></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="current tsd-kind-class"><a href="DynamicModule.html" class="tsd-kind-icon">Dynamic<wbr/>Module</a><ul><li class="tsd-kind-constructor tsd-parent-kind-class"><a href="DynamicModule.html#constructor" class="tsd-kind-icon">constructor</a></li><li class="tsd-kind-method tsd-parent-kind-class tsd-has-type-parameter"><a href="DynamicModule.html#ref" class="tsd-kind-icon">ref</a></li></ul></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li><li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>